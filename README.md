<div align="center">
    <img src="/logo/logo.png">
</div>

<h3 align="center">HTMX QUTE QUARKUS</h3>

## About The Project

The 'htmx-qute-quarkus' project demonstrates how to efficiently build a web application using the Quarkus framework with
HTMX for hypermedia driven UI interactions and the Qute template engine for HTML rendering. This project leverages Java 21's
latest features, including pattern matching, structured concurrency, and advanced garbage collection. It incorporates
the Ports & Adapters architecture to facilitate the transition from monolithic structures to microservices, enhancing
maintainability and scalability. Additionally, the project includes CI/CD configurations to simplify setting up a local
environment with a single command, complete with E2E testing and GitHub pipelines integration. This project is an
exploratory journey into building distributed systems, providing valuable insights for similar endeavors.

## Getting Started

This is an example of how you may give instructions on setting up your project locally.
To get a local copy up and running follow these simple example steps.

### Prerequisites

* java 21+
* docker

### Installation

1. Clone the repo
   ```shell
   git clone git@github.com:nanobreaker/htmx-qute-quarkus.git
   ```

## Usage

### Build

```shell
./mvnw clean install -Pmonolith
```

### Run

```shell
./mvnw quarkus:dev -Pmonolith 
```

### Roadmap

* Add calendar functionality
    * Calendar domain model
    * Calendar repository
    * Calendar commands & queries
    * Calendar command & queries handlers
    * Calendar resource (REST)
* Integrate with Debezium & Apache Pulsar
    * Build Outbox implementation to update User, Todo and Calendar based on domain events
    * Domain events will be generated by Debezium
    * Apache Pulsar (similar to Kafka) to use as transport layer for events delivery
* Split monolith into microservices
    * User microservice
    * Todo microservice
    * Calendar microservice
* Create script to set up local development cluster
* Create GitHub actions
    * Run E2E tests
    * Build project artifacts and publish to public nexus repository
    * Build docker images and publish to public repository
    * Deploy application to dev cluster

### Spikes

* Is it worth implementing Aggregate Root pattern for the domain layer?
* Is it worth using Apache Pulsar with Debezium for such small project?
* Good practices for handling authentication/authorization in micro-service cluster

### Ports & Adapters Diagram

This project is based on popular architecture "Ports & Adapters" also some creeps call it "Hexagon" 'till they figure
out what it is actually is.

The idea is really simple, we have ports & adapters, which can be primary (driving) or secondary (driven).
For this project I've implemented CQRS based on VertX EventBus which can act as Mediator.

* **Primary Adapters**
    * REST
    * Messaging System
* **Primary Ports**
    * Commands (change domain model state)
        * User Commands
        * Todo Commands
        * Calendar Commands
    * Queries (query models)
        * User Queries
        * Todo Queries
        * Calendar Queries
* **Secondary Adapters**
    * Database drivers
        * postgresql
* **Secondary Ports**
    * Repositories
        * User Repository
        * Todo Repository
        * Calendar Repository
* **Domain**
    * Domain Models
        * User Model
        * Todo Model
        * Calendar Model
    * Command Handlers
        * User Command Handlers
        * Todo Command Handlers
        * Calendar Command Handlers
    * Query Handlers
        * User Query Handlers
        * Todo Query Handlers
        * Calendar Query Handlers

#### High level overview

![P&A High Level](documentation/diagrams/ports-adapters-high-level.png)

#### Adding project specific details

![P&A Details](documentation/diagrams/ports-adapters-details.png)

### Change-Data-Capture Flow Diagram

![CDC Diagram](documentation/diagrams/cdc.png)