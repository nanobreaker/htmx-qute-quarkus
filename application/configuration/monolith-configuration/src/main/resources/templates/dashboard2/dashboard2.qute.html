<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=2">
    <meta name="_csrf_header" content="{inject:csrf.token}"/>
    <title>htmx-qute-quarkus</title>

    {! HTMX !}
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/sse.js"></script>
    {! HyperScript !}
    <script src="https://unpkg.com/hyperscript.org@0.9.12"></script>
    <script src="https://unpkg.com/hyperscript.org@0.9.12/dist/eventsource.js"></script>
    <script type="text/hyperscript">
        eventsource CliUpdates from http://localhost:8080/command/feedback
            on feedback
                put it into #feedback
            end

            on open
                log 'connection opened.'
            end
        end

        def navigation.focusById(id)
            js(id)
                document.getElementById(id).focus()
            end
        end
    </script>
    {! CSS !}
    <link rel="stylesheet" href="https://unpkg.com/missing.css@1.1.1">
    <link rel="stylesheet" href="/styles/styles.css">
    {! FAVICON !}
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.ico">
</head>
<body _="on keyup[key is ':']
            navigation.focusById('command')
         end">
<div id="dashboard"
     class="fullscreen">

    <div id="top-bar"
         style="background: var(--almost-night)">
        <label class="float:left  padding-inline arrow-right ok bg fg">alice@dashboard</label>
        <label class="float:right padding-inline arrow-left  ok bg fg">version {applicationVersion ?: 'unknown'}</label>
    </div>

    <div id="content">
        <pre id="feedback">
        </pre>
    </div>

    <div id="bottom-bar"
         style="background: var(--almost-night)">
        <label class="float:left  padding-inline"
               style="background: var(--magenta); color: var(--fg)">
            TODO
        </label>
        <div class="triangle"
             style="color: var(--magenta)">
        </div>
    </div>

    <div id="command-line"
         class="command-line">
        <label class="command-prompt" for="command">:</label>
        <input class="command-input" id="command"
               name="command"
               type="search"
               hx-post="/command/execute"
               hx-trigger="keyup[key=='Enter']"
               _='on keyup
                            debounced at 500ms
                            fetch /command/analyze
                                with
                                    body: my value,
                                    method: "POST"'>
    </div>
</div>
</body>
</html>